// @codekit-append "/modules/bubble-menu.js"
// @codekit-append "/modules/chart.js"
function convertStringToFloat(e){return Number(e.replace(/[^0-9\.]+/g,""))}$(document).ready(function(){function e(e,t){var n=Math.round(e*Math.pow(10,t))/Math.pow(10,t);return n}function t(t){var n=$(t.currentTarget).attr("id"),r=$("#ReceiptCost").val(),i=$("#ReceiptLitres").val(),s=$("#ReceiptPricePerLitre").val();(n==="ReceiptCost"||n==="ReceiptLitres")&&r>0&&i>0?$("#ReceiptPricePerLitre").val(e(r/i,3)):(n==="ReceiptCost"||n==="ReceiptPricePerLitre")&&r>0&&s>0&&$("#ReceiptLitres").val(e(r/s,2))}$("#ReceiptCost, #ReceiptLitres, #ReceiptPricePerLitre").on("keydown",t);var n=function(){var e=$("option:selected",this).attr("data-odometer");$("#ReceiptOdometer").attr("placeholder","Previously "+e);$("#ReceiptOdometer").attr("min",e)};$("#ReceiptVehicleId").on("change",n)});(function(){function u(){a()}function a(){n.addEventListener("click",f);r&&r.addEventListener("click",f);t.addEventListener("click",function(e){var t=e.target;i&&t!==n&&f()})}function f(){if(isAnimating)return!1;isAnimating=!0;if(i){classie.remove(e,"show-menu");setTimeout(function(){path.attr("d",initialPath);isAnimating=!1},300)}else{classie.add(e,"show-menu");var t=0,n=function(e){if(e>stepsTotal-1){isAnimating=!1;return}path.animate({path:steps[e]},e===0?400:500,e===0?mina.easein:mina.elastic,function(){n(e)});e++};n(t)}i=!i}var e=document.body,t=document.querySelector(".content-wrap"),n=document.getElementById("open-button"),r=document.getElementById("close-button"),i=!1,s=document.getElementById("morph-shape"),o=Snap(s.querySelector("svg"));path=o.select("path");initialPath=this.path.attr("d"),steps=s.getAttribute("data-morph-open").split(";");stepsTotal=steps.length;isAnimating=!1;u()})();var CommuteChart=function(){var t=$("canvas.chart"),n=!1;t.length>0&&t.data("chart-debug")&&(n=!0);n&&console.log("Setting up CommuteChart: ",t);if(t.length>0){var r={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,0.1)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!1,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},i=t.data("chart-source")!=""?t.data("chart-source"):{},s=t.data("chart-item")!=""?t.data("chart-item"):"",o=t.data("chart-x")!=""?t.data("chart-x"):"",u=t.data("chart-y")!=""?t.data("chart-y"):"",a=t.data("chart-order")!=""?t.data("chart-order"):"",f={xAxis:[],yAxis:[]};n&&console.log("Data source: ",i);n&&console.log("Data format: ",typeof i);if(typeof i=="string"){$data_dom=$(i);if($data_dom.length>0){n&&console.log("Query selector: ",$data_dom);$(s,$data_dom).each(function(e,t){data_x=$(o,t);data_y=$(u,t);if(data_x!==null&&data_y!==null){f.xAxis.push(data_x.text());f.yAxis.push(convertStringToFloat(data_y.text()))}})}}else $(i).each(function(e,t){f.xAxis.push(t[o]);f.yAxis.push(t[u])});if(a==="reverse"){f.xAxis.reverse();f.yAxis.reverse()}n&&console.table(f);var l={labels:f.xAxis,datasets:[{label:"Price",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:f.yAxis}]},c=t.get(0).getContext("2d"),h=(new Chart(c)).Line(l,r)}}();